<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Register - Salon App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container mt-5">
    <h2 class="text-center mb-4">Create an Account</h2>

    <div class="card shadow p-4 mx-auto" style="max-width:450px;">
        <form id="registerForm">
            <!-- Username -->
            <div class="mb-3">
                <label class="form-label">Username</label>
                <input type="text" id="username" class="form-control" required />
            </div>

            <!-- Email -->
            <div class="mb-3">
                <label class="form-label">Email</label>
                <input type="email" id="email" class="form-control" required />
            </div>

            <!-- Contact Number -->
            <div class="mb-3">
                <label class="form-label">Contact Number</label>
                <input type="text" id="contactNumber" class="form-control" maxlength="10" required />
            </div>

            <!-- Password -->
            <div class="mb-3">
                <label class="form-label">Password</label>
                <input type="password" id="password" class="form-control" required />
            </div>

            <!-- Role -->
            <div class="mb-3">
                <label class="form-label">Role</label>
                <select id="role" class="form-select" required>
                    <option value="">Select Role</option>
                    <option value="CUSTOMER">Customer</option>
                    <option value="SALON_OWNER">Salon Owner</option>
                </select>
            </div>

            <button type="submit" class="btn btn-primary w-100">Register</button>
        </form>

        <div id="responseMsg" class="mt-3 text-center"></div>
    </div>
</div>

<script>
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const payload = {
        username: document.getElementById('username').value.trim(),
        email: document.getElementById('email').value.trim(),
        contactNumber: document.getElementById('contactNumber').value.trim(),
        password: document.getElementById('password').value,
        role: document.getElementById('role').value
      };

      const REGISTER_URL = '/api/auth/register'; // Change if backend path differs

      try {
        const res = await fetch(REGISTER_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        let data;
        const ct = res.headers.get('content-type') || '';
        if (ct.includes('application/json')) data = await res.json();
        else data = await res.text();

        if (res.ok) {
          document.getElementById('responseMsg').innerHTML =
            `<div class="alert alert-success">üéâ Registration successful! <a href="login.html">Login here</a></div>`;
          document.getElementById('registerForm').reset();
        } else {
          const msg = (typeof data === 'string') ? data : (data.message || JSON.stringify(data));
          document.getElementById('responseMsg').innerHTML =
            `<div class="alert alert-danger">‚ùå Registration failed: ${msg}</div>`;
        }
      } catch (err) {
        console.error('Register error:', err);
        document.getElementById('responseMsg').innerHTML =
          `<div class="alert alert-danger">‚ö†Ô∏è Network error. Please try again later.</div>`;
      }
    });
</script>
</body>
</html>
